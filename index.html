<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WordQuest Plus Learn Advanced Mandarin</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --accent: #4895ef;
            --success: #4cc9f0;
            --error: #f72585;
            --warning: #f8961e;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: #f0f2f5;
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin: auto;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        h1 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 2.5rem;
        }

        h2 {
            color: var(--secondary);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .logo {
            font-size: 3.5rem;
            color: var(--primary);
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: var(--gray);
            margin-bottom: 30px;
            font-size: 1.2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 4px 10px rgba(67, 97, 238, 0.3);
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(67, 97, 238, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-error {
            background-color: var(--error);
        }

        .btn-warning {
            background-color: var(--warning);
        }

        .game-container, .selection-container, .result-container {
            display: none;
        }

        .question {
            font-size: 1.8rem;
            margin: 30px 0;
            color: var(--dark);
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .options-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .option-btn {
            padding: 15px;
            border-radius: 10px;
            background-color: var(--light);
            border: 2px solid #e9ecef;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60px;
        }

        .option-btn:hover {
            background-color: #e9ecef;
            border-color: #dee2e6;
        }

        .option-btn i {
            margin-right: 10px;
        }

        .feedback {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            display: none;
        }

        .feedback.correct {
            background-color: rgba(76, 201, 240, 0.2);
            border-left: 5px solid var(--success);
            color: var(--success);
        }

        .feedback.incorrect {
            background-color: rgba(247, 37, 133, 0.2);
            border-left: 5px solid var(--error);
            color: var(--error);
        }

        .example {
            font-style: italic;
            margin-top: 10px;
            color: var(--dark);
        }

        .score-container {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .score-box {
            background-color: var(--light);
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
            margin: 5px;
            min-width: 100px;
        }

        .progress-container {
            width: 100%;
            background-color: #e9ecef;
            border-radius: 10px;
            margin: 20px 0;
            height: 10px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s ease;
        }

        .result-icon {
            font-size: 5rem;
            margin-bottom: 20px;
        }

        .success .result-icon {
            color: var(--success);
        }

        .average .result-icon {
            color: var(--accent);
        }

        .fail .result-icon {
            color: var(--error);
        }

        .speak-btn {
            background-color: var(--accent);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-size: 1.5rem;
            box-shadow: 0 4px 10px rgba(72, 149, 239, 0.3);
        }

        .speak-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 15px rgba(72, 149, 239, 0.4);
        }

        .theme-selector {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
        }

        .theme-btn {
            padding: 10px 15px;
            margin: 8px;
            border-radius: 50px;
            background-color: var(--light);
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .theme-btn:hover {
            background-color: #e9ecef;
            border-color: #dee2e6;
        }

        .theme-btn.selected {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .level-selector {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .level-btn {
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 50px;
            background-color: var(--light);
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .level-btn:hover {
            background-color: #e9ecef;
            border-color: #dee2e6;
        }

        .level-btn.selected {
            color: white;
        }

        .level-easy.selected {
            background-color: #4caf50;
            border-color: #4caf50;
        }

        .level-medium.selected {
            background-color: #ff9800;
            border-color: #ff9800;
        }

        .level-hard.selected {
            background-color: #f44336;
            border-color: #f44336;
        }

        .word-count {
            margin: 15px 0;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .timer {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-left: auto;
            display: flex;
            align-items: center;
        }

        .timer i {
            margin-right: 5px;
        }

        .header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .options-container {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .theme-selector {
                flex-direction: column;
                align-items: center;
            }
            
            .level-selector {
                flex-wrap: wrap;
            }
            
            .level-btn {
                margin: 5px;
            }
        }

        /* Animations */
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }

        .bounce {
            animation: bounce 1s;
        }

        @keyframes shake {
            0%, 100% {transform: translateX(0);}
            10%, 30%, 50%, 70%, 90% {transform: translateX(-5px);}
            20%, 40%, 60%, 80% {transform: translateX(5px);}
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes pulse {
            0% {transform: scale(1);}
            50% {transform: scale(1.05);}
            100% {transform: scale(1);}
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }

        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0% {transform: translateY(0px);}
            50% {transform: translateY(-10px);}
            100% {transform: translateY(0px);}
        }

        /* Theme colors */
        .theme-food {
            --primary: #e85d04;
            --secondary: #dc2f02;
        }

        .theme-animals {
            --primary: #4d908e;
            --secondary: #277da1;
        }

        .theme-technology {
            --primary: #5e60ce;
            --secondary: #6930c3;
        }

        .theme-business {
            --primary: #9d4edd;
            --secondary: #7b2cbf;
        }

        .theme-travel {
            --primary: #4361ee;
            --secondary: #3a0ca3;
        }

        .theme-health {
            --primary: #2a9d8f;
            --secondary: #264653;
        }

        .theme-default {
            --primary: #4361ee;
            --secondary: #7209b7;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="start-container">
            <div class="logo">
                <i class="fas fa-language"></i>
            </div>
            <h1>WordQuest Plus</h1>
            <p class="subtitle">Learn Advanced Mandarin Through Personalized Games</p>
            <button id="start-btn" class="btn">Start Game</button>
        </div>

        <div id="selection-container" class="selection-container">
            <h2>Choose Your Options</h2>
            
            <div class="level-selector">
                <button class="level-btn level-easy" data-level="easy">Easy</button>
                <button class="level-btn level-medium" data-level="medium">Medium</button>
                <button class="level-btn level-hard" data-level="hard">Hard</button>
            </div>
            
            <h3 style="margin: 20px 0 10px; color: var(--gray);">Choose a Theme:</h3>
            <div class="theme-selector">
                <button class="theme-btn" data-theme="all">All</button>
                <button class="theme-btn" data-theme="food">食物 (Food)</button>
                <button class="theme-btn" data-theme="animals">动物 (Animals)</button>
                <button class="theme-btn" data-theme="technology">技术 (Technology)</button>
                <button class="theme-btn" data-theme="business">商业 (Business)</button>
                <button class="theme-btn" data-theme="travel">旅行 (Travel)</button>
                <button class="theme-btn" data-theme="health">健康 (Health)</button>
            </div>
            
            <p class="word-count">You will play with <span id="selected-word-count">10</span> words</p>
            
            <button id="confirm-selection-btn" class="btn">Confirm and Play</button>
        </div>

        <div id="game-container" class="game-container">
            <div class="header-row">
                <div class="score-box">
                    <i class="fas fa-question-circle"></i> <span id="question-count">1</span>/<span id="total-questions">10</span>
                </div>
                <div class="timer">
                    <i class="far fa-clock"></i> <span id="time">60</span>s
                </div>
            </div>
            
            <div class="progress-container">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
            
            <div class="question" id="question"></div>
            
            <div id="speak-container" class="speak-btn">
                <i class="fas fa-volume-up"></i>
            </div>

            <div id="options-container" class="options-container"></div>

            <div id="feedback" class="feedback">
                <div id="feedback-text"></div>
                <div id="example" class="example"></div>
            </div>

            <button id="next-btn" class="btn" style="display: none;">Next Question</button>
        </div>

        <div id="result-container" class="result-container">
            <div id="result-icon" class="result-icon">
                <i class="fas fa-trophy"></i>
            </div>
            <h2 id="result-title">Congratulations!</h2>
            <p id="result-message">You completed the quiz!</p>
            
            <div class="score-container">
                <div class="score-box">
                    <i class="fas fa-check"></i> <span id="final-correct">0</span> correct
                </div>
                <div class="score-box">
                    <i class="fas fa-times"></i> <span id="final-wrong">0</span> wrong
                </div>
                <div class="score-box">
                    <i class="fas fa-star"></i> <span id="final-score">0</span> points
                </div>
            </div>
            
            <div style="margin: 30px 0;">
                <h3 style="margin-bottom: 15px;">Words to review:</h3>
                <div id="review-words" style="text-align: left; max-width: 500px; margin: 0 auto;"></div>
            </div>
            
            <button id="restart-btn" class="btn">Play Again</button>
        </div>
    </div>

    <script>
        // Word database organized by themes and difficulty
        const wordDatabase = {
            food: {
                easy: [
                    { pt: "apple", en: "苹果 (píng guǒ)", exemplo: "I eat an 苹果 every morning. (我每天早上吃一个苹果。)" },
                    { pt: "bread", en: "面包 (miàn bāo)", exemplo: "Could you buy some 面包? (你能买些面包吗？)" },
                    { pt: "cheese", en: "奶酪 (nǎi lào)", exemplo: "This 奶酪 is delicious. (这个奶酪很好吃。)" },
                    { pt: "chicken", en: "鸡肉 (jī ròu)", exemplo: "We're having 鸡肉 for dinner. (我们晚餐吃鸡肉。)" },
                    { pt: "egg", en: "鸡蛋 (jī dàn)", exemplo: "She had 鸡蛋 for breakfast. (她早餐吃了鸡蛋。)" },
                    { pt: "fish", en: "鱼 (yú)", exemplo: "Do you like 鱼? (你喜欢鱼吗？)" },
                    { pt: "meat", en: "肉 (ròu)", exemplo: "He doesn't eat 肉. (他不吃肉。)" },
                    { pt: "milk", en: "牛奶 (niú nǎi)", exemplo: "Add some 牛奶 to your coffee. (给你的咖啡加些牛奶。)" },
                    { pt: "rice", en: "米饭 (mǐ fàn)", exemplo: "米饭 is a staple food in many countries. (米饭是许多国家的主食。)" },
                    { pt: "salt", en: "盐 (yán)", exemplo: "This needs more 盐. (这个需要更多盐。)" }
                ],
                medium: [
                    { pt: "avocado", en: "鳄梨 (è lí)", exemplo: "鳄梨 toast is very popular. (鳄梨吐司非常受欢迎。)" },
                    { pt: "eggplant", en: "茄子 (qié zi)", exemplo: "茄子 parmesan is delicious. (茄子帕尔马干酪很美味。)" },
                    { pt: "spinach", en: "菠菜 (bō cài)", exemplo: "菠菜 is rich in iron. (菠菜富含铁。)" },
                    { pt: "blueberry", en: "蓝莓 (lán méi)", exemplo: "蓝莓 muffins are my favorite. (蓝莓松饼是我的最爱。)" },
                    { pt: "lobster", en: "龙虾 (lóng xiā)", exemplo: "龙虾 is expensive but delicious. (龙虾很贵但美味。)" },
                    { pt: "cinnamon", en: "肉桂 (ròu guì)", exemplo: "肉桂 adds great flavor. (肉桂增添了很好的味道。)" },
                    { pt: "basil", en: "罗勒 (luó lè)", exemplo: "罗勒 is essential for pesto. (罗勒是香蒜酱的必备。)" },
                    { pt: "saffron", en: "藏红花 (zàng hóng huā)", exemplo: "藏红花 is the most expensive spice. (藏红花是最贵的香料。)" },
                    { pt: "quinoa", en: "藜麦 (lí mài)", exemplo: "藜麦 is very nutritious. (藜麦非常有营养。)" },
                    { pt: "wasabi", en: "芥末 (jiè mò)", exemplo: "芥末 is very spicy. (芥末很辣。)" }
                ],
                hard: [
                    { pt: "star fruit", en: "杨桃 (yáng táo)", exemplo: "杨桃 has a unique shape. (杨桃有独特的形状。)" },
                    { pt: "Brazilian grape tree fruit", en: "嘉宝果 (jiā bǎo guǒ)", exemplo: "嘉宝果 grows directly on the trunk. (嘉宝果直接长在树干上。)" },
                    { pt: "pistachio", en: "开心果 (kāi xīn guǒ)", exemplo: "开心果 ice cream is my favorite. (开心果冰淇淋是我的最爱。)" },
                    { pt: "tamarind", en: "罗望子 (luó wàng zǐ)", exemplo: "罗望子 is used in many Asian dishes. (罗望子用于许多亚洲菜肴。)" },
                    { pt: "jackfruit", en: "菠萝蜜 (bō luó mì)", exemplo: "菠萝蜜 can be used as a meat substitute. (菠萝蜜可用作肉类替代品。)" },
                    { pt: "annatto", en: "胭脂树红 (yān zhī shù hóng)", exemplo: "胭脂树红 is used for coloring food. (胭脂树红用于食品着色。)" },
                    { pt: "feijoa", en: "费约果 (fèi yuē guǒ)", exemplo: "费约果 has a unique flavor. (费约果有独特的味道。)" },
                    { pt: "chayote", en: "佛手瓜 (fó shǒu guā)", exemplo: "佛手瓜 is very versatile in cooking. (佛手瓜在烹饪中用途广泛。)" },
                    { pt: "cupuaçu", en: "古布阿苏 (gǔ bù ā sū)", exemplo: "古布阿苏 is a Brazilian fruit. (古布阿苏是巴西水果。)" },
                    { pt: "sea cucumber", en: "海参 (hǎi shēn)", exemplo: "海参 is considered a delicacy. (海参被认为是美味佳肴。)" }
                ]
            },
            animals: {
                easy: [
                    { pt: "dog", en: "狗 (gǒu)", exemplo: "The 狗 is barking. (狗在叫。)" },
                    { pt: "cat", en: "猫 (māo)", exemplo: "The 猫 is sleeping. (猫在睡觉。)" },
                    { pt: "bird", en: "鸟 (niǎo)", exemplo: "That 鸟 is singing. (那只鸟在唱歌。)" },
                    { pt: "fish", en: "鱼 (yú)", exemplo: "The 鱼 is swimming. (鱼在游泳。)" },
                    { pt: "cow", en: "牛 (niú)", exemplo: "The 牛 gives milk. (牛产奶。)" },
                    { pt: "pig", en: "猪 (zhū)", exemplo: "猪 are very intelligent. (猪非常聪明。)" },
                    { pt: "horse", en: "马 (mǎ)", exemplo: "She rides a 马. (她骑马。)" },
                    { pt: "sheep", en: "羊 (yáng)", exemplo: "The 羊 gives wool. (羊产羊毛。)" },
                    { pt: "chicken", en: "鸡 (jī)", exemplo: "The 鸡 lays eggs. (鸡下蛋。)" },
                    { pt: "mouse", en: "老鼠 (lǎo shǔ)", exemplo: "The 老鼠 is small. (老鼠很小。)" }
                ],
                medium: [
                    { pt: "elephant", en: "大象 (dà xiàng)", exemplo: "The 大象 has a long trunk. (大象有长鼻子。)" },
                    { pt: "giraffe", en: "长颈鹿 (cháng jǐng lù)", exemplo: "长颈鹿 have long necks. (长颈鹿有长脖子。)" },
                    { pt: "rhinoceros", en: "犀牛 (xī niú)", exemplo: "The 犀牛 has a horn. (犀牛有角。)" },
                    { pt: "hippopotamus", en: "河马 (hé mǎ)", exemplo: "河马 live in rivers. (河马生活在河里。)" },
                    { pt: "crocodile", en: "鳄鱼 (è yú)", exemplo: "鳄鱼 are dangerous. (鳄鱼很危险。)" },
                    { pt: "penguin", en: "企鹅 (qǐ é)", exemplo: "企鹅 live in cold places. (企鹅生活在寒冷的地方。)" },
                    { pt: "bat", en: "蝙蝠 (biān fú)", exemplo: "蝙蝠 use echolocation. (蝙蝠使用回声定位。)" },
                    { pt: "owl", en: "猫头鹰 (māo tóu yīng)", exemplo: "猫头鹰 can turn their heads 270 degrees. (猫头鹰可以转头270度。)" },
                    { pt: "turtle", en: "乌龟 (wū guī)", exemplo: "乌龟 live a long time. (乌龟寿命很长。)" },
                    { pt: "otter", en: "水獭 (shuǐ tǎ)", exemplo: "水獭 hold hands while sleeping. (水獭睡觉时手拉手。)" }
                ],
                hard: [
                    { pt: "platypus", en: "鸭嘴兽 (yā zuǐ shòu)", exemplo: "The 鸭嘴兽 is a mammal that lays eggs. (鸭嘴兽是产卵的哺乳动物。)" },
                    { pt: "anteater", en: "食蚁兽 (shí yǐ shòu)", exemplo: "The 食蚁兽 has a long tongue. (食蚁兽有长舌头。)" },
                    { pt: "coati", en: "长鼻浣熊 (cháng bí huàn xióng)", exemplo: "长鼻浣熊 are related to raccoons. (长鼻浣熊与浣熊有关。)" },
                    { pt: "lemur", en: "狐猴 (hú hóu)", exemplo: "狐猴 are native to Madagascar. (狐猴原产于马达加斯加。)" },
                    { pt: "hermit crab", en: "寄居蟹 (jì jū xiè)", exemplo: "寄居蟹 use empty shells. (寄居蟹使用空壳。)" },
                    { pt: "numbat", en: "袋食蚁兽 (dài shí yǐ shòu)", exemplo: "The 袋食蚁兽 is an Australian marsupial. (袋食蚁兽是澳大利亚有袋动物。)" },
                    { pt: "Tasmanian devil", en: "袋獾 (dài huān)", exemplo: "The 袋獾 has a strong bite. (袋獾咬合力很强。)" },
                    { pt: "axolotl", en: "美西螈 (měi xī yuán)", exemplo: "The 美西螈 can regenerate limbs. (美西螈可以再生肢体。)" },
                    { pt: "tarsier", en: "眼镜猴 (yǎn jìng hóu)", exemplo: "眼镜猴 have huge eyes. (眼镜猴有大眼睛。)" },
                    { pt: "aye-aye", en: "指猴 (zhǐ hóu)", exemplo: "The 指猴 is a type of lemur. (指猴是一种狐猴。)" }
                ]
            },
            technology: {
                easy: [
                    { pt: "computer", en: "电脑 (diàn nǎo)", exemplo: "I work on my 电脑. (我在电脑上工作。)" },
                    { pt: "phone", en: "电话 (diàn huà)", exemplo: "My 电话 is new. (我的电话是新的。)" },
                    { pt: "internet", en: "互联网 (hù lián wǎng)", exemplo: "The 互联网 is slow today. (今天互联网很慢。)" },
                    { pt: "email", en: "电子邮件 (diàn zǐ yóu jiàn)", exemplo: "Send me an 电子邮件. (给我发电子邮件。)" },
                    { pt: "website", en: "网站 (wǎng zhàn)", exemplo: "This 网站 is useful. (这个网站很有用。)" },
                    { pt: "app", en: "应用程序 (yìng yòng chéng xù)", exemplo: "I use this 应用程序 every day. (我每天使用这个应用程序。)" },
                    { pt: "password", en: "密码 (mì mǎ)", exemplo: "Don't share your 密码. (不要分享你的密码。)" },
                    { pt: "photo", en: "照片 (zhào piàn)", exemplo: "Take a 照片. (拍张照片。)" },
                    { pt: "video", en: "视频 (shì pín)", exemplo: "Watch this 视频. (观看这个视频。)" },
                    { pt: "mouse", en: "鼠标 (shǔ biāo)", exemplo: "The 鼠标 is wireless. (鼠标是无线的。)" }
                ],
                medium: [
                    { pt: "algorithm", en: "算法 (suàn fǎ)", exemplo: "This 算法 is efficient. (这个算法很高效。)" },
                    { pt: "encryption", en: "加密 (jiā mì)", exemplo: "加密 protects your data. (加密保护你的数据。)" },
                    { pt: "cloud", en: "云 (yún)", exemplo: "Save the file to the 云. (把文件保存到云。)" },
                    { pt: "artificial intelligence", en: "人工智能 (rén gōng zhì néng)", exemplo: "人工智能 is advancing. (人工智能正在进步。)" },
                    { pt: "virtual reality", en: "虚拟现实 (xū nǐ xiàn shí)", exemplo: "虚拟现实 is immersive. (虚拟现实很沉浸。)" },
                    { pt: "blockchain", en: "区块链 (qū kuài liàn)", exemplo: "区块链 is used for cryptocurrencies. (区块链用于加密货币。)" },
                    { pt: "big data", en: "大数据 (dà shù jù)", exemplo: "大数据 requires special tools. (大数据需要特殊工具。)" },
                    { pt: "machine learning", en: "机器学习 (jī qì xué xí)", exemplo: "机器学习 improves with data. (机器学习随数据改进。)" },
                    { pt: "interface", en: "界面 (jiè miàn)", exemplo: "The 界面 is user-friendly. (界面用户友好。)" },
                    { pt: "cryptocurrency", en: "加密货币 (jiā mì huò bì)", exemplo: "Bitcoin is a 加密货币. (比特币是一种加密货币。)" }
                ],
                hard: [
                    { pt: "quantum computing", en: "量子计算 (liàng zǐ jì suàn)", exemplo: "量子计算 solves complex problems. (量子计算解决复杂问题。)" },
                    { pt: "neuromorphic", en: "神经形态 (shén jīng xíng tài)", exemplo: "神经形态 chips mimic the brain. (神经形态芯片模仿大脑。)" },
                    { pt: "exascale", en: "百亿亿次级 (bǎi yì yì cì jí)", exemplo: "百亿亿次级 computing is the next frontier. (百亿亿次级计算是下一个前沿。)" },
                    { pt: "photonic", en: "光子 (guāng zǐ)", exemplo: "光子 computing uses light. (光子计算使用光。)" },
                    { pt: "memristor", en: "忆阻器 (yì zǔ qì)", exemplo: "忆阻器 can store information. (忆阻器可以存储信息。)" },
                    { pt: "spintronics", en: "自旋电子学 (zì xuán diàn zǐ xué)", exemplo: "自旋电子学 uses electron spin. (自旋电子学使用电子自旋。)" },
                    { pt: "nanorobotics", en: "纳米机器人 (nà mǐ jī qì rén)", exemplo: "纳米机器人 has medical applications. (纳米机器人有医疗应用。)" },
                    { pt: "biocomputing", en: "生物计算 (shēng wù jì suàn)", exemplo: "生物计算 uses biological molecules. (生物计算使用生物分子。)" },
                    { pt: "fog computing", en: "雾计算 (wù jì suàn)", exemplo: "雾计算 extends cloud computing. (雾计算扩展云计算。)" },
                    { pt: "homomorphic", en: "同态 (tóng tài)", exemplo: "同态 encryption allows computation on encrypted data. (同态加密允许加密数据计算。)" }
                ]
            },
            business: {
                easy: [
                    { pt: "company", en: "公司 (gōng sī)", exemplo: "She works for a tech 公司. (她在一家科技公司工作。)" },
                    { pt: "money", en: "钱 (qián)", exemplo: "We need more 钱. (我们需要更多钱。)" },
                    { pt: "sale", en: "销售 (xiāo shòu)", exemplo: "The 销售 starts tomorrow. (销售明天开始。)" },
                    { pt: "purchase", en: "购买 (gòu mǎi)", exemplo: "Keep the 购买 receipt. (保留购买收据。)" },
                    { pt: "price", en: "价格 (jià gé)", exemplo: "The 价格 is too high. (价格太高了。)" },
                    { pt: "profit", en: "利润 (lì rùn)", exemplo: "The company made a 利润. (公司盈利了。)" },
                    { pt: "loss", en: "亏损 (kuī sǔn)", exemplo: "We suffered a 亏损. (我们亏损了。)" },
                    { pt: "boss", en: "老板 (lǎo bǎn)", exemplo: "My 老板 is strict. (我的老板很严格。)" },
                    { pt: "employee", en: "员工 (yuán gōng)", exemplo: "We have 50 员工. (我们有50名员工。)" },
                    { pt: "customer", en: "顾客 (gù kè)", exemplo: "The 顾客 is always right. (顾客永远是对的。)" }
                ],
                medium: [
                    { pt: "investment", en: "投资 (tóu zī)", exemplo: "This is a good 投资. (这是一个好的投资。)" },
                    { pt: "strategy", en: "策略 (cè lüè)", exemplo: "We need a new 策略. (我们需要新策略。)" },
                    { pt: "market", en: "市场 (shì chǎng)", exemplo: "The 市场 is competitive. (市场竞争激烈。)" },
                    { pt: "competition", en: "竞争 (jìng zhēng)", exemplo: "The 竞争 is fierce. (竞争很激烈。)" },
                    { pt: "equity", en: "股权 (gǔ quán)", exemplo: "He has 股权 in the company. (他在公司有股权。)" },
                    { pt: "merger", en: "合并 (hé bìng)", exemplo: "The 合并 created a giant. (合并创造了一个巨头。)" },
                    { pt: "acquisition", en: "收购 (shōu gòu)", exemplo: "The 收购 was expensive. (收购很昂贵。)" },
                    { pt: "profitable", en: "盈利的 (yíng lì de)", exemplo: "The business became 盈利的. (业务变得盈利。)" },
                    { pt: "revenue", en: "收入 (shōu rù)", exemplo: "收入 increased this year. (今年收入增加了。)" },
                    { pt: "startup", en: "初创公司 (chū chuàng gōng sī)", exemplo: "He founded a tech 初创公司. (他创立了一家科技初创公司。)" }
                ],
                hard: [
                    { pt: "disruptive", en: "颠覆性的 (diān fù xìng de)", exemplo: "This technology is 颠覆性的. (这项技术是颠覆性的。)" },
                    { pt: "synergy", en: "协同效应 (xié tóng xiào yìng)", exemplo: "The merger created 协同效应. (合并创造了协同效应。)" },
                    { pt: "scope", en: "范围 (fàn wéi)", exemplo: "The project 范围 changed. (项目范围改变了。)" },
                    { pt: "benchmarking", en: "基准测试 (jī zhǔn cè shì)", exemplo: "We did 基准测试 with competitors. (我们与竞争对手进行了基准测试。)" },
                    { pt: "crowdfunding", en: "众筹 (zhòng chóu)", exemplo: "The product was funded via 众筹. (产品通过众筹获得资金。)" },
                    { pt: "private equity", en: "私募股权 (sī mù gǔ quán)", exemplo: "The company received 私募股权 investment. (公司获得了私募股权投资。)" },
                    { pt: "due diligence", en: "尽职调查 (jìn zhí diào chá)", exemplo: "We're conducting 尽职调查. (我们正在进行尽职调查。)" },
                    { pt: "turnover", en: "营业额 (yíng yè é)", exemplo: "Employee 营业额 is high. (员工营业额很高。)" },
                    { pt: "commoditization", en: "商品化 (shāng pǐn huà)", exemplo: "商品化 reduces profit margins. (商品化降低了利润率。)" },
                    { pt: "bootstrapping", en: "自举 (zì jǔ)", exemplo: "The company grew through 自举. (公司通过自举成长。)" }
                ]
            },
            travel: {
                easy: [
                    { pt: "airplane", en: "飞机 (fēi jī)", exemplo: "The 飞机 is big. (飞机很大。)" },
                    { pt: "hotel", en: "酒店 (jiǔ diàn)", exemplo: "We stayed at a nice 酒店. (我们住在一家不错的酒店。)" },
                    { pt: "beach", en: "海滩 (hǎi tān)", exemplo: "The 海滩 is beautiful. (海滩很美。)" },
                    { pt: "map", en: "地图 (dì tú)", exemplo: "Look at the 地图. (看地图。)" },
                    { pt: "passport", en: "护照 (hù zhào)", exemplo: "Don't forget your 护照. (别忘了你的护照。)" },
                    { pt: "luggage", en: "行李 (xíng lǐ)", exemplo: "My 行李 is heavy. (我的行李很重。)" },
                    { pt: "taxi", en: "出租车 (chū zū chē)", exemplo: "Let's take a 出租车. (我们坐出租车吧。)" },
                    { pt: "bus", en: "公共汽车 (gōng gòng qì chē)", exemplo: "The 公共汽车 is late. (公共汽车晚点了。)" },
                    { pt: "train", en: "火车 (huǒ chē)", exemplo: "The 火车 is fast. (火车很快。)" },
                    { pt: "restaurant", en: "餐厅 (cān tīng)", exemplo: "This 餐厅 is famous. (这家餐厅很有名。)" }
                ],
                medium: [
                    { pt: "ticket", en: "票 (piào)", exemplo: "I bought my plane 票. (我买了飞机票。)" },
                    { pt: "booking", en: "预订 (yù dìng)", exemplo: "Confirm your 预订. (确认你的预订。)" },
                    { pt: "check-in", en: "办理登机 (bàn lǐ dēng jī)", exemplo: "Online 办理登机 is available. (可以在线办理登机。)" },
                    { pt: "tourist", en: "游客 (yóu kè)", exemplo: "Many 游客 visit here. (许多游客来这里参观。)" },
                    { pt: "guide", en: "导游 (dǎo yóu)", exemplo: "The 导游 was knowledgeable. (导游知识渊博。)" },
                    { pt: "attraction", en: "景点 (jǐng diǎn)", exemplo: "This is a popular 景点. (这是一个受欢迎的景点。)" },
                    { pt: "cruise", en: "游轮 (yóu lún)", exemplo: "We went on a 游轮. (我们乘坐了游轮。)" },
                    { pt: "visa", en: "签证 (qiān zhèng)", exemplo: "Do you need a 签证? (你需要签证吗？)" },
                    { pt: "exchange", en: "兑换 (duì huàn)", exemplo: "Where is the currency 兑换? (货币兑换在哪里？)" },
                    { pt: "accommodation", en: "住宿 (zhù sù)", exemplo: "We found nice 住宿. (我们找到了不错的住宿。)" }
                ],
                hard: [
                    { pt: "jet lag", en: "时差反应 (shí chā fǎn yìng)", exemplo: "I have terrible 时差反应. (我有严重的时差反应。)" },
                    { pt: "layover", en: "中途停留 (zhōng tú tíng liú)", exemplo: "We have a 4-hour 中途停留. (我们有4小时的中途停留。)" },
                    { pt: "itinerary", en: "行程 (xíng chéng)", exemplo: "Here's our travel 行程. (这是我们的旅行行程。)" },
                    { pt: "all-inclusive", en: "全包式 (quán bāo shì)", exemplo: "We booked an 全包式 resort. (我们预订了全包式度假村。)" },
                    { pt: "hostel", en: "青年旅社 (qīng nián lǚ shè)", exemplo: "青年旅社 are budget-friendly. (青年旅社经济实惠。)" },
                    { pt: "backpacking", en: "背包旅行 (bēi bāo lǚ xíng)", exemplo: "We're going 背包旅行 in Europe. (我们要去欧洲背包旅行。)" },
                    { pt: "red-eye", en: "红眼航班 (hóng yǎn háng bān)", exemplo: "I took the 红眼航班. (我乘坐了红眼航班。)" },
                    { pt: "staycation", en: "居家度假 (jū jiā dù jià)", exemplo: "We're having a 居家度假 this year. (今年我们要居家度假。)" },
                    { pt: "ecotourism", en: "生态旅游 (shēng tài lǚ yóu)", exemplo: "生态旅游 is growing. (生态旅游正在增长。)" },
                    { pt: "voluntourism", en: "志愿旅游 (zhì yuàn lǚ yóu)", exemplo: "She does 志愿旅游 trips. (她参加志愿旅游旅行。)" }
                ]
            },
            health: {
                easy: [
                    { pt: "doctor", en: "医生 (yī shēng)", exemplo: "The 医生 will see you now. (医生现在要见你。)" },
                    { pt: "hospital", en: "医院 (yī yuàn)", exemplo: "He's in the 医院. (他在医院。)" },
                    { pt: "medicine", en: "药 (yào)", exemplo: "Take your 药. (吃药。)" },
                    { pt: "pain", en: "疼痛 (téng tòng)", exemplo: "I have 疼痛 in my back. (我背疼。)" },
                    { pt: "fever", en: "发烧 (fā shāo)", exemplo: "She has a 发烧. (她发烧了。)" },
                    { pt: "flu", en: "流感 (liú gǎn)", exemplo: "I have the 流感. (我得了流感。)" },
                    { pt: "heart", en: "心脏 (xīn zàng)", exemplo: "The 心脏 pumps blood. (心脏泵血。)" },
                    { pt: "blood", en: "血液 (xuè yè)", exemplo: "They did a 血液 test. (他们做了血液检查。)" },
                    { pt: "bone", en: "骨头 (gǔ tou)", exemplo: "I broke a 骨头. (我骨折了。)" },
                    { pt: "skin", en: "皮肤 (pí fū)", exemplo: "My 皮肤 is dry. (我的皮肤干燥。)" }
                ],
                medium: [
                    { pt: "surgery", en: "手术 (shǒu shù)", exemplo: "He needs 手术. (他需要手术。)" },
                    { pt: "diagnosis", en: "诊断 (zhěn duàn)", exemplo: "The 诊断 was correct. (诊断是正确的。)" },
                    { pt: "symptom", en: "症状 (zhèng zhuàng)", exemplo: "What are your 症状? (你有什么症状？)" },
                    { pt: "allergy", en: "过敏 (guò mǐn)", exemplo: "I have a peanut 过敏. (我对花生过敏。)" },
                    { pt: "antibiotic", en: "抗生素 (kàng shēng sù)", exemplo: "Take the 抗生素. (服用抗生素。)" },
                    { pt: "vaccine", en: "疫苗 (yì miáo)", exemplo: "Get your flu 疫苗. (接种流感疫苗。)" },
                    { pt: "blood pressure", en: "血压 (xuè yā)", exemplo: "My 血压 is high. (我的血压高。)" },
                    { pt: "cholesterol", en: "胆固醇 (dǎn gù chún)", exemplo: "Check your 胆固醇. (检查你的胆固醇。)" },
                    { pt: "meditation", en: "冥想 (míng xiǎng)", exemplo: "冥想 reduces stress. (冥想减轻压力。)" },
                    { pt: "yoga", en: "瑜伽 (yú jiā)", exemplo: "She practices 瑜伽 daily. (她每天练习瑜伽。)" }
                ],
                hard: [
                    { pt: "physiotherapy", en: "物理治疗 (wù lǐ zhì liáo)", exemplo: "I need 物理治疗. (我需要物理治疗。)" },
                    { pt: "homeopathy", en: "顺势疗法 (shùn shì liáo fǎ)", exemplo: "顺势疗法 is controversial. (顺势疗法有争议。)" },
                    { pt: "acupuncture", en: "针灸 (zhēn jiǔ)", exemplo: "针灸 helps with pain. (针灸有助于缓解疼痛。)" },
                    { pt: "osteopathy", en: "整骨疗法 (zhěng gǔ liáo fǎ)", exemplo: "整骨疗法 treats the whole body. (整骨疗法治疗全身。)" },
                    { pt: "chiropractic", en: "脊椎按摩 (jǐ zhuī àn mó)", exemplo: "脊椎按摩 adjusts the spine. (脊椎按摩调整脊柱。)" },
                    { pt: "endoscopy", en: "内窥镜检查 (nèi kuī jìng jiǎn chá)", exemplo: "The 内窥镜检查 showed nothing. (内窥镜检查没有发现异常。)" },
                    { pt: "MRI", en: "磁共振成像 (cí gòng zhèn chéng xiàng)", exemplo: "I had an 磁共振成像 scan. (我做了磁共振成像扫描。)" },
                    { pt: "placebo", en: "安慰剂 (ān wèi jì)", exemplo: "The 安慰剂 effect is real. (安慰剂效应是真实的。)" },
                    { pt: "epidemiology", en: "流行病学 (liú xíng bìng xué)", exemplo: "流行病学 studies disease spread. (流行病学研究疾病传播。)" },
                    { pt: "pathogen", en: "病原体 (bìng yuán tǐ)", exemplo: "The 病原体 was identified. (病原体已被识别。)" }
                ]
            }
        };

        // Game variables
        let currentQuestion = 0;
        let score = 0;
        let correctAnswers = 0;
        let wrongAnswers = 0;
        let questions = [];
        let currentCorrectAnswer = "";
        let selectedTheme = "all";
        let selectedLevel = "easy";
        let timer;
        let timeLeft = 60;
        let incorrectWords = [];

        // DOM elements
        const startContainer = document.getElementById('start-container');
        const selectionContainer = document.getElementById('selection-container');
        const gameContainer = document.getElementById('game-container');
        const resultContainer = document.getElementById('result-container');
        const startBtn = document.getElementById('start-btn');
        const confirmSelectionBtn = document.getElementById('confirm-selection-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const questionElement = document.getElementById('question');
        const optionsContainer = document.getElementById('options-container');
        const feedbackElement = document.getElementById('feedback');
        const feedbackText = document.getElementById('feedback-text');
        const exampleElement = document.getElementById('example');
        const correctCountElement = document.getElementById('final-correct');
        const wrongCountElement = document.getElementById('final-wrong');
        const scoreElement = document.getElementById('final-score');
        const resultTitleElement = document.getElementById('result-title');
        const resultMessageElement = document.getElementById('result-message');
        const resultIconElement = document.getElementById('result-icon');
        const progressBar = document.getElementById('progress-bar');
        const speakBtn = document.getElementById('speak-container');
        const questionCountElement = document.getElementById('question-count');
        const totalQuestionsElement = document.getElementById('total-questions');
        const timeElement = document.getElementById('time');
        const reviewWordsElement = document.getElementById('review-words');
        const wordCountElement = document.getElementById('selected-word-count');

        // Event listeners
        startBtn.addEventListener('click', showSelectionScreen);
        confirmSelectionBtn.addEventListener('click', startGame);
        nextBtn.addEventListener('click', nextQuestion);
        restartBtn.addEventListener('click', restartGame);
        speakBtn.addEventListener('click', speakWord);

        // Theme and level selectors
        document.querySelectorAll('.theme-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                selectedTheme = this.dataset.theme;
                updateWordCount();
            });
        });

        document.querySelectorAll('.level-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                selectedLevel = this.dataset.level;
                updateWordCount();
            });
        });

        // Show selection screen
        function showSelectionScreen() {
            startContainer.style.display = 'none';
            selectionContainer.style.display = 'block';
            gameContainer.style.display = 'none';
            resultContainer.style.display = 'none';
            
            // Select first theme and level by default
            document.querySelector('.theme-btn[data-theme="all"]').classList.add('selected');
            document.querySelector('.level-btn[data-level="easy"]').classList.add('selected');
            
            updateWordCount();
        }

        // Update word count based on selection
        function updateWordCount() {
            let count = 0;
            
            if (selectedTheme === 'all') {
                for (const theme in wordDatabase) {
                    count += wordDatabase[theme][selectedLevel].length;
                }
            } else {
                count = wordDatabase[selectedTheme][selectedLevel].length;
            }
            
            wordCountElement.textContent = Math.min(20, count);
        }

        // Start the game
        function startGame() {
            // Prepare questions based on selection
            questions = prepareQuestions();
            
            // Reset variables
            currentQuestion = 0;
            score = 0;
            correctAnswers = 0;
            wrongAnswers = 0;
            incorrectWords = [];
            timeLeft = 60;
            
            // Update UI
            totalQuestionsElement.textContent = questions.length;
            updateTimerDisplay();
            
            // Show game container and hide others
            startContainer.style.display = 'none';
            selectionContainer.style.display = 'none';
            resultContainer.style.display = 'none';
            gameContainer.style.display = 'block';
            
            // Start timer
            startTimer();
            
            // Show first question
            showQuestion();
        }

        // Prepare questions based on selections
        function prepareQuestions() {
            let availableWords = [];
            
            if (selectedTheme === 'all') {
                // Get words from all themes at selected level
                for (const theme in wordDatabase) {
                    availableWords = availableWords.concat(wordDatabase[theme][selectedLevel]);
                }
            } else {
                // Get words from selected theme at selected level
                availableWords = wordDatabase[selectedTheme][selectedLevel];
            }
            
            // Shuffle and get up to 20 words
            const shuffled = shuffleArray([...availableWords]);
            return shuffled.slice(0, 20);
        }

        // Show current question
        function showQuestion() {
            if (currentQuestion >= questions.length) {
                endGame();
                return;
            }
            
            const question = questions[currentQuestion];
            currentCorrectAnswer = question.en;
            
            // Update question counter
            questionCountElement.textContent = currentQuestion + 1;
            
            // Show the question
            questionElement.textContent = `What is the Mandarin translation of "${question.pt}"?`;
            
            // Generate answer options
            const options = generateOptions(question.en);
            
            // Clear previous options
            optionsContainer.innerHTML = '';
            
            // Add new options
            options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                button.textContent = option;
                button.addEventListener('click', () => checkAnswer(option));
                optionsContainer.appendChild(button);
            });
            
            // Hide feedback and next button
            feedbackElement.style.display = 'none';
            nextBtn.style.display = 'none';
            
            // Update progress bar
            progressBar.style.width = `${(currentQuestion / questions.length) * 100}%`;
        }

        // Generate answer options
        function generateOptions(correctAnswer) {
            let wrongOptions = [];
            
            // Get wrong words from same theme and level
            if (selectedTheme === 'all') {
                // If all themes selected, we can get from any theme
                for (const theme in wordDatabase) {
                    const words = wordDatabase[theme][selectedLevel]
                        .filter(word => word.en !== correctAnswer)
                        .map(word => word.en);
                    wrongOptions = wrongOptions.concat(words);
                }
            } else {
                // Get only from selected theme
                wrongOptions = wordDatabase[selectedTheme][selectedLevel]
                    .filter(word => word.en !== correctAnswer)
                    .map(word => word.en);
            }
            
            // Shuffle and get 3 wrong options
            const shuffledWrong = shuffleArray([...wrongOptions]).slice(0, 3);
            
            // Combine with correct and shuffle
            const allOptions = [...shuffledWrong, correctAnswer];
            return shuffleArray(allOptions);
        }

        // Check answer
        function checkAnswer(selectedAnswer) {
            clearInterval(timer); // Stop timer
            
            const question = questions[currentQuestion];
            const isCorrect = selectedAnswer === question.en;
            
            // Disable all buttons
            const optionButtons = document.querySelectorAll('.option-btn');
            optionButtons.forEach(button => {
                button.disabled = true;
                if (button.textContent === question.en) {
                    button.style.backgroundColor = '#d4edda';
                    button.style.borderColor = '#c3e6cb';
                } else if (button.textContent === selectedAnswer && !isCorrect) {
                    button.style.backgroundColor = '#f8d7da';
                    button.style.borderColor = '#f5c6cb';
                }
            });
            
            // Update score
            if (isCorrect) {
                score += calculatePoints();
                correctAnswers++;
                feedbackElement.className = 'feedback correct';
                feedbackText.innerHTML = '<i class="fas fa-check-circle"></i> Correct!';
                questionElement.classList.add('bounce');
            } else {
                wrongAnswers++;
                incorrectWords.push(question);
                feedbackElement.className = 'feedback incorrect';
                feedbackText.innerHTML = '<i class="fas fa-times-circle"></i> Incorrect!';
                questionElement.classList.add('shake');
            }
            
            // Show example
            exampleElement.textContent = question.exemplo;
            
            // Show feedback
            feedbackElement.style.display = 'block';
            nextBtn.style.display = 'block';
            
            // Update score on screen
            updateScore();
            
            // Remove animations after some time
            setTimeout(() => {
                questionElement.classList.remove('bounce', 'shake');
            }, 1000);
        }

        // Calculate points based on remaining time
        function calculatePoints() {
            const basePoints = 10;
            const timeBonus = Math.floor(timeLeft / 5); // Max 12 bonus points
            return basePoints + timeBonus;
        }

        // Next question
        function nextQuestion() {
            currentQuestion++;
            timeLeft = 60;
            updateTimerDisplay();
            startTimer();
            showQuestion();
        }

        // Start timer
        function startTimer() {
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    timeOut();
                }
            }, 1000);
        }

        // Update timer display
        function updateTimerDisplay() {
            timeElement.textContent = timeLeft;
            
            // Change color when time is running out
            if (timeLeft <= 10) {
                timeElement.style.color = 'var(--error)';
                timeElement.classList.add('pulse');
            } else {
                timeElement.style.color = 'var(--primary)';
                timeElement.classList.remove('pulse');
            }
        }

        // Time out
        function timeOut() {
            const question = questions[currentQuestion];
            incorrectWords.push(question);
            
            // Disable all buttons
            const optionButtons = document.querySelectorAll('.option-btn');
            optionButtons.forEach(button => {
                button.disabled = true;
                if (button.textContent === question.en) {
                    button.style.backgroundColor = '#d4edda';
                    button.style.borderColor = '#c3e6cb';
                }
            });
            
            // Show feedback
            feedbackElement.className = 'feedback incorrect';
            feedbackText.innerHTML = '<i class="fas fa-clock"></i> Time out!';
            exampleElement.textContent = question.exemplo;
            feedbackElement.style.display = 'block';
            nextBtn.style.display = 'block';
        }

        // End game
        function endGame() {
            clearInterval(timer);
            gameContainer.style.display = 'none';
            resultContainer.style.display = 'block';
            
            // Update progress bar to 100%
            progressBar.style.width = '100%';
            
            // Show final statistics
            correctCountElement.textContent = correctAnswers;
            wrongCountElement.textContent = wrongAnswers;
            scoreElement.textContent = score;
            
            // Determine message based on performance
            let resultClass, title, message;
            const percentage = (correctAnswers / questions.length) * 100;
            
            if (percentage >= 80) {
                resultClass = 'success';
                title = 'Excellent!';
                message = 'You were amazing! Your vocabulary is excellent.';
                resultIconElement.innerHTML = '<i class="fas fa-trophy"></i>';
            } else if (percentage >= 50) {
                resultClass = 'average';
                title = 'Good job!';
                message = 'You are on the right track! Practice a bit more to improve.';
                resultIconElement.innerHTML = '<i class="fas fa-star"></i>';
            } else {
                resultClass = 'fail';
                title = 'Keep practicing!';
                message = "Don't get discouraged! The more you practice, the better you'll get.";
                resultIconElement.innerHTML = '<i class="fas fa-redo"></i>';
            }
            
            // Apply classes and texts
            resultContainer.className = `result-container ${resultClass}`;
            resultTitleElement.textContent = title;
            resultMessageElement.textContent = message;
            
            // Show words to review
            showReviewWords();
        }

        // Show words to review
        function showReviewWords() {
            if (incorrectWords.length === 0) {
                reviewWordsElement.innerHTML = '<p>No words to review - perfect!</p>';
                return;
            }
            
            let html = '<ul style="list-style-type: none;">';
            incorrectWords.forEach(word => {
                html += `
                    <li style="margin-bottom: 10px; padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
                        <strong>${word.pt}</strong> → ${word.en}<br>
                        <small style="color: #6c757d;">${word.exemplo}</small>
                    </li>
                `;
            });
            html += '</ul>';
            
            reviewWordsElement.innerHTML = html;
        }

        // Restart game
        function restartGame() {
            showSelectionScreen();
        }

        // Update score on screen
        function updateScore() {
            // Updated during the game directly in checkAnswer
        }

        // Speak word
        function speakWord() {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(currentCorrectAnswer);
                utterance.lang = 'zh-CN';
                utterance.rate = 0.9;
                speechSynthesis.speak(utterance);
                
                // Add visual effect
                speakBtn.classList.add('bounce');
                setTimeout(() => {
                    speakBtn.classList.remove('bounce');
                }, 1000);
            } else {
                alert('Your browser does not support speech synthesis.');
            }
        }

        // Shuffle array (Fisher-Yates algorithm)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Apply selected theme
        function applyTheme(theme) {
            document.body.className = theme;
        }
    </script>
</body>
</html>